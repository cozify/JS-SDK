!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("axios")):"function"==typeof define&&define.amd?define(["exports","axios"],t):t((e=e||self).CozifySDK={},e.axios)}(this,(function(e,t){"use strict";t=t&&t.hasOwnProperty("default")?t.default:t;var r=function(e){var t,r=e.Symbol;return"function"==typeof r?r.observable?t=r.observable:(t=r("observable"),r.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),n=function(){return Math.random().toString(36).substring(7).split("").join(".")},o={INIT:"@@redux/INIT"+n(),REPLACE:"@@redux/REPLACE"+n(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+n()}};function i(e,t,n){var c;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(i)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var u=e,a=t,s=[],f=s,l=!1;function d(){f===s&&(f=s.slice())}function p(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return a}function h(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return d(),f.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,d();var r=f.indexOf(e);f.splice(r,1)}}}function y(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,a=u(a,e)}finally{l=!1}for(var t=s=f,r=0;r<t.length;r++){(0,t[r])()}return e}return y({type:o.INIT}),(c={dispatch:y,subscribe:h,getState:p,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");u=e,y({type:o.REPLACE})}})[r]=function(){var e,t=h;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(p())}return r(),{unsubscribe:t(r)}}})[r]=function(){return this},e},c}function c(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var i=t[n];"function"==typeof e[i]&&(r[i]=e[i])}var u,a=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:o.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:o.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+o.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){u=e}return function(e,t){if(void 0===e&&(e={}),u)throw u;for(var n=!1,o={},i=0;i<a.length;i++){var s=a[i],f=r[s],l=e[s],d=f(l,t);if(void 0===d){var p=c(s,t);throw new Error(p)}o[s]=d,n=n||d!==l}return n?o:e}}function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}function f(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}function l(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return s({},r,{dispatch:n=f.apply(void 0,i)(r.dispatch)})}}}var d,p,h,y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},v=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},b=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),g="undefined"!=typeof Symbol?Symbol("immer-nothing"):(h=!0,(p="immer-nothing")in(d={})?Object.defineProperty(d,p,{value:h,enumerable:!0,configurable:!0,writable:!0}):d[p]=h,d),E="undefined"!=typeof Symbol?Symbol("immer-draftable"):"__$immer_draftable",m="undefined"!=typeof Symbol?Symbol("immer-state"):"__$immer_state";function O(e){return!!e&&!!e[m]}function w(e){if(!e||"object"!==(void 0===e?"undefined":y(e)))return!1;if(Array.isArray(e))return!0;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype||(!!e[E]||!!e.constructor[E])}var _=Object.assign||function(e,t){for(var r in t)N(t,r)&&(e[r]=t[r]);return e},S="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function T(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(Array.isArray(e))return e.slice();var r=Object.create(Object.getPrototypeOf(e));return S(e).forEach((function(n){if(n!==m){var o=Object.getOwnPropertyDescriptor(e,n);if(o.get){if(!t)throw new Error("Immer drafts cannot have computed properties");o.value=o.get.call(e)}o.enumerable?r[n]=o.value:Object.defineProperty(r,n,{value:o.value,writable:!0,configurable:!0})}})),r}function I(e,t){if(Array.isArray(e))for(var r=0;r<e.length;r++)t(r,e[r],e);else S(e).forEach((function(r){return t(r,e[r],e)}))}function A(e,t){return Object.getOwnPropertyDescriptor(e,t).enumerable}function N(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function D(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}var j={},C=[],P=function(){return C[C.length-1]};function R(e,t){var r=Array.isArray(e),n=k(e);I(n,(function(t){!function(e,t,r){var n=j[t];n?n.enumerable=r:j[t]=n={configurable:!0,enumerable:r,get:function(){return function(e,t){M(e);var r=K(e)[t];if(!e.finalizing&&r===e.base[t]&&w(r))return x(e),e.copy[t]=R(r,e);return r}(this[m],t)},set:function(e){!function(e,t,r){if(M(e),e.assigned[t]=!0,!e.modified){if(D(K(e)[t],r))return;L(e),x(e)}e.copy[t]=r}(this[m],t,e)}};Object.defineProperty(e,t,n)}(n,t,r||A(e,t))}));var o={scope:t?t.scope:P(),modified:!1,finalizing:!1,finalized:!1,assigned:{},parent:t,base:e,draft:n,copy:null,revoke:U,revoked:!1};return function(e,t,r){Object.defineProperty(e,t,{value:r,enumerable:!1,writable:!0})}(n,m,o),o.scope.push(o),n}function U(){this.revoked=!0}function K(e){return e.copy||e.base}function L(e){e.modified||(e.modified=!0,e.parent&&L(e.parent))}function x(e){e.copy||(e.copy=k(e.base))}function k(e){var t=e&&e[m];if(t){t.finalizing=!0;var r=T(t.draft,!0);return t.finalizing=!1,r}return T(e)}function M(e){if(!0===e.revoked)throw new Error("Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+JSON.stringify(K(e)))}function H(e){for(var t=e.base,r=e.draft,n=Object.keys(r),o=n.length-1;o>=0;o--)if(void 0===t[n[o]]&&!N(t,n[o]))return!0;return n.length!==Object.keys(t).length}function G(e){var t=e.draft;if(t.length!==e.base.length)return!0;var r=Object.getOwnPropertyDescriptor(t,t.length-1);return!(!r||r.get)}var z=Object.freeze({scopes:C,currentScope:P,willFinalize:function(e,t,r){var n=P();n.forEach((function(e){return e.finalizing=!0})),void 0!==e&&e!==t||(r&&function e(t){if(!t||"object"!==(void 0===t?"undefined":y(t)))return;var r=t[m];if(!r)return;var n=r.base,o=r.draft,i=r.assigned;if(Array.isArray(t)){if(G(r)){if(L(r),i.length=!0,o.length<n.length)for(var c=o.length;c<n.length;c++)i[c]=!1;else for(var u=n.length;u<o.length;u++)i[u]=!0;for(var a=0;a<o.length;a++)void 0===i[a]&&e(o[a])}}else Object.keys(o).forEach((function(t){void 0!==n[t]||N(n,t)?i[t]||e(o[t]):(i[t]=!0,L(r))})),Object.keys(n).forEach((function(e){void 0!==o[e]||N(o,e)||(i[e]=!1,L(r))}))}(t),function(e){for(var t=e.length-1;t>=0;t--){var r=e[t];!1===r.modified&&(Array.isArray(r.base)?G(r)&&L(r):H(r)&&L(r))}}(n))},createDraft:R}),F=[],B=function(){return F[F.length-1]};function $(e,t){var r={scope:t?t.scope:B(),modified:!1,finalized:!1,assigned:{},parent:t,base:e,draft:null,drafts:{},copy:null,revoke:null},n=Array.isArray(e)?Proxy.revocable([r],W):Proxy.revocable(r,V),o=n.revoke,i=n.proxy;return r.draft=i,r.revoke=o,r.scope.push(r),i}var V={get:function(e,t){if(t===m)return e;var r=e.drafts;if(!e.modified&&N(r,t))return r[t];var n=Y(e)[t];if(e.finalized||!w(n))return n;if(e.modified){if(n!==e.base[t])return n;r=e.copy}return r[t]=$(n,e)},has:function(e,t){return t in Y(e)},ownKeys:function(e){return Reflect.ownKeys(Y(e))},set:function(e,t,r){if(!e.modified){if(r?D(e.base[t],r)||r===e.drafts[t]:D(e.base[t],r)&&t in e.base)return!0;q(e)}return e.assigned[t]=!0,e.copy[t]=r,!0},deleteProperty:function(e,t){(void 0!==e.base[t]||t in e.base)&&(e.assigned[t]=!1,q(e));e.copy&&delete e.copy[t];return!0},getOwnPropertyDescriptor:function(e,t){var r=Y(e),n=Reflect.getOwnPropertyDescriptor(r,t);n&&(n.writable=!0,n.configurable=!Array.isArray(r)||"length"!==t);return n},defineProperty:function(){throw new Error("Object.defineProperty() cannot be used on an Immer draft")},getPrototypeOf:function(e){return Object.getPrototypeOf(e.base)},setPrototypeOf:function(){throw new Error("Object.setPrototypeOf() cannot be used on an Immer draft")}},W={};function Y(e){return e.copy||e.base}function q(e){e.modified||(e.modified=!0,e.copy=_(T(e.base),e.drafts),e.drafts=null,e.parent&&q(e.parent))}I(V,(function(e,t){W[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),W.deleteProperty=function(e,t){if(isNaN(parseInt(t)))throw new Error("Immer only supports deleting array indices");return V.deleteProperty.call(this,e[0],t)},W.set=function(e,t,r){if("length"!==t&&isNaN(parseInt(t)))throw new Error("Immer only supports setting array indices and the 'length' property");return V.set.call(this,e[0],t,r)};var X=Object.freeze({scopes:F,currentScope:B,willFinalize:function(){},createDraft:$});function J(e,t,r,n){Array.isArray(e.base)?function(e,t,r,n){for(var o=e.base,i=e.copy,c=e.assigned,u=Math.min(o.length,i.length),a=0;a<u;a++)if(c[a]&&o[a]!==i[a]){var s=t.concat(a);r.push({op:"replace",path:s,value:i[a]}),n.push({op:"replace",path:s,value:o[a]})}if(u<i.length){for(var f=u;f<i.length;f++)r.push({op:"add",path:t.concat(f),value:i[f]});n.push({op:"replace",path:t.concat("length"),value:o.length})}else if(u<o.length){r.push({op:"replace",path:t.concat("length"),value:i.length});for(var l=u;l<o.length;l++)n.push({op:"add",path:t.concat(l),value:o[l]})}}(e,t,r,n):function(e,t,r,n){var o=e.base,i=e.copy;I(e.assigned,(function(e,c){var u=o[e],a=i[e],s=c?e in o?"replace":"add":"remove";if(u!==a||"replace"!==s){var f=t.concat(e);r.push("remove"===s?{op:s,path:f}:{op:s,path:f,value:a}),n.push("add"===s?{op:"remove",path:f}:"remove"===s?{op:"add",path:f,value:u}:{op:"replace",path:f,value:u})}}))}(e,t,r,n)}function Z(e,t){for(var r=0;r<t.length;r++){var n=t[r],o=n.path;if(0===o.length&&"replace"===n.op)e=n.value;else{for(var i=e,c=0;c<o.length-1;c++)if(!(i=i[o[c]])||"object"!==(void 0===i?"undefined":y(i)))throw new Error("Cannot apply patch, path doesn't resolve: "+o.join("/"));var u=o[o.length-1];switch(n.op){case"replace":case"add":i[u]=n.value;break;case"remove":if(Array.isArray(i)){if(u!==i.length-1)throw new Error("Only the last index of an array can be removed, index: "+u+", length: "+i.length);i.length-=1}else delete i[u];break;default:throw new Error("Unsupported patch operation: "+n.op)}}}return e}var Q={useProxies:"undefined"!=typeof Proxy&&"undefined"!=typeof Reflect,autoFreeze:"undefined"==typeof process&&"verifyMinified"===function(){}.name,onAssign:null,onDelete:null,onCopy:null},ee=new(function(){function e(t){v(this,e),_(this,Q,t),this.setUseProxies(this.useProxies),this.produce=this.produce.bind(this)}return b(e,[{key:"produce",value:function(e,t,r){var n=this;if("function"==typeof e&&"function"!=typeof t){var o=t;return t=e,function(){for(var e=arguments.length,r=Array(e>1?e-1:0),i=1;i<e;i++)r[i-1]=arguments[i];var c=arguments.length>0&&void 0!==arguments[0]?arguments[0]:o;return n.produce(c,(function(e){var n;return(n=t).call.apply(n,[e,e].concat(r))}))}}if("function"!=typeof t)throw new Error("if first argument is not a function, the second argument to produce should be a function");if(void 0!==r&&"function"!=typeof r)throw new Error("the third argument of a producer should not be set or a function");var i=void 0;if(w(e)){this.scopes.push([]);var c=this.createDraft(e);try{i=t.call(c,c),this.willFinalize(i,c,!!r);var u=r&&[],a=r&&[];if(void 0===i||i===c)i=this.finalize(c,[],u,a);else{if(c[m].modified)throw new Error("An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.");w(i)&&(i=this.finalize(i)),r&&(u.push({op:"replace",path:[],value:i}),a.push({op:"replace",path:[],value:e}))}}finally{this.currentScope().forEach((function(e){return e.revoke()})),this.scopes.pop()}r&&r(u,a)}else if(void 0===(i=t(e)))return e;return i===g?void 0:i}},{key:"setAutoFreeze",value:function(e){this.autoFreeze=e}},{key:"setUseProxies",value:function(e){this.useProxies=e,_(this,e?X:z)}},{key:"applyPatches",value:function(e,t){return O(e)?Z(e,t):this.produce(e,(function(e){return Z(e,t)}))}},{key:"finalize",value:function(e,t,r,n){var o=this,i=e[m];if(!i)return Object.isFrozen(e)?e:this.finalizeTree(e);if(i.scope!==this.currentScope())return e;if(!i.modified)return i.base;if(!i.finalized){if(i.finalized=!0,this.finalizeTree(i.draft,t,r,n),this.onDelete)if(this.useProxies){var c=i.assigned;for(var u in c)c[u]||this.onDelete(i,u)}else{var a=i.base,s=i.copy;I(a,(function(e){N(s,e)||o.onDelete(i,e)}))}this.onCopy&&this.onCopy(i),this.autoFreeze&&1===this.scopes.length&&Object.freeze(i.copy),r&&J(i,t,r,n)}return i.copy}},{key:"finalizeTree",value:function(e,t,r,n){var o=this,i=e[m];i&&(this.useProxies||(i.finalizing=!0,i.copy=T(i.draft,!0),i.finalizing=!1),e=i.copy);var c=this.onAssign;return I(e,(function u(a,s,f){if(s===f)throw Error("Immer forbids circular references");var l=!!i&&f===e;if(O(s)){if(s=r&&l&&!i.assigned[a]?o.finalize(s,t.concat(a),r,n):o.finalize(s),Array.isArray(f)||A(f,a)?f[a]=s:Object.defineProperty(f,a,{value:s}),l&&s===i.base[a])return}else{if(l&&D(s,i.base[a]))return;w(s)&&!Object.isFrozen(s)&&I(s,u)}l&&c&&c(i,a,s)})),e}}]),e}()),te=ee.produce,re=(ee.setAutoFreeze.bind(ee),ee.setUseProxies.bind(ee),ee.applyPatches.bind(ee),{clear:function(){re.results={},re.size=0},results:{},size:0}),ne=/"[^"]+"|`[^`]+`|'[^']+'|[^.[\]]+/g,oe=/^\d+$/i,ie=/^"[^"]+"|`[^`]+`|'[^']+'$/,ce=function(e,t){for(var r=e.length,n=[],o=0;o<r;o++)n[o]=t(e[o]);return n},ue=function(e){var t=function(e){return ie.test(e)}(e)?e.slice(1,e.length-1):e;return function(e){return!(!e||!e.length)&&oe.test(e)}(t)?+t:t},ae=Array.isArray,se=function(e){if("string"==typeof e)return function(e){return re.results[e]?re.results[e]:(re.size>500&&re.clear(),re.results[e]=e?ce(e.match(ne),ue):[e],re.size++,re.results[e])}(e);if(ae(e))return ce(e,ue);var t=ue(e);return["number"==typeof t?t:""+t]},fe="function"==typeof Map,le="function"==typeof Set,de="function"==typeof WeakSet,pe=Object.keys,he=function(e,t){return e&&"object"==typeof e&&t.add(e)},ye=function(e,t,r,n){for(var o,i=0;i<e.length;i++)if(r((o=e[i])[0],t[0],n)&&r(o[1],t[1],n))return!0;return!1},ve=function(e,t,r,n){for(var o=0;o<e.length;o++)if(r(e[o],t,n))return!0;return!1},be=function(e,t){return e===t||e!=e&&t!=t},ge=function(e){return e.constructor===Object},Ee=function(e){return"function"==typeof e.then},me=function(e){return!(!e.$$typeof||!e._store)},Oe=function(e){return function(t){var r=e||t;return function(e,t,n){void 0===n&&(n=de?new WeakSet:Object.create({_values:[],add:function(e){this._values.push(e)},has:function(e){return!!~this._values.indexOf(e)}}));var o=n.has(e),i=n.has(t);return o||i?o&&i:(he(e,n),he(t,n),r(e,t,n))}}},we=function(e){var t=[];return e.forEach((function(e,r){return t.push([r,e])})),t},_e=function(e){var t=[];return e.forEach((function(e){return t.push(e)})),t},Se=function(e,t,r,n){if(e.length!==t.length)return!1;for(var o=0;o<e.length;o++)if(!r(e[o],t[o],n))return!1;return!0},Te=function(e,t,r,n){var o=we(e),i=we(t);if(o.length!==i.length)return!1;for(var c=0;c<o.length;c++)if(!ye(i,o[c],r,n)||!ye(o,i[c],r,n))return!1;return!0},Ie=function(e,t,r,n){var o,i=pe(e),c=pe(t);if(i.length!==c.length)return!1;for(var u=0;u<i.length;u++){if(o=i[u],!ve(c,o,be))return!1;if(("_owner"!==o||!me(e)||!me(t))&&!r(e[o],t[o],n))return!1}return!0},Ae=function(e,t){return e.source===t.source&&e.global===t.global&&e.ignoreCase===t.ignoreCase&&e.multiline===t.multiline&&e.unicode===t.unicode&&e.sticky===t.sticky&&e.lastIndex===t.lastIndex},Ne=function(e,t,r,n){var o=_e(e),i=_e(t);if(o.length!==i.length)return!1;for(var c=0;c<o.length;c++)if(!ve(i,o[c],r,n)||!ve(o,i[c],r,n))return!1;return!0},De=Array.isArray,je=function(e){var t="function"==typeof e?e(r):r;function r(e,r,n){if(be(e,r))return!0;var o=typeof e;if(o!==typeof r||"object"!==o||!e||!r)return!1;if(ge(e)&&ge(r))return Ie(e,r,t,n);var i=De(e),c=De(r);if(i||c)return i===c&&Se(e,r,t,n);var u=e instanceof Date,a=r instanceof Date;if(u||a)return u===a&&be(e.getTime(),r.getTime());var s=e instanceof RegExp,f=r instanceof RegExp;if(s||f)return s===f&&Ae(e,r);if(Ee(e)||Ee(r))return e===r;if(fe){var l=e instanceof Map,d=r instanceof Map;if(l||d)return l===d&&Te(e,r,t,n)}if(le){var p=e instanceof Set,h=r instanceof Set;if(p||h)return p===h&&Ne(e,r,t,n)}return Ie(e,r,t,n)}return r};je(Oe()),je(Oe(be)),je(),je((function(){return be}));function Ce(e,t){return e===t}function Pe(e,t,r){if(null===t||null===r||t.length!==r.length)return!1;for(var n=t.length,o=0;o<n;o++)if(!e(t[o],r[o]))return!1;return!0}function Re(e){var t=Array.isArray(e[0])?e[0]:e;if(!t.every((function(e){return"function"==typeof e}))){var r=t.map((function(e){return typeof e})).join(", ");throw new Error("Selector creators expect all input-selectors to be functions, instead received the following types: ["+r+"]")}return t}!function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n]}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ce,r=null,n=null;return function(){return Pe(t,r,arguments)||(n=e.apply(null,arguments)),r=arguments,n}}));var Ue="function"==typeof Symbol?Symbol("curriable placeholder"):60881,Ke=function(e,t,r){return function(){var n,o=r.length,i=arguments,c=i.length,u=[],a=0,s=t;if(o)for(var f=0;f<o;f++)u[f]=n=r[f]===Ue&&a<c?i[a++]:r[f],n!==Ue&&--s;if(a<c)for(;a<c;a++)u[u.length]=n=i[a],n!==Ue&&a<t&&--s;return s>0?Ke(e,t,u):e.apply(this,u)}},Le=function(e,t){void 0===t&&(t=e.length);var r=Ke(e,t,[]);return r.arity=t,r.fn=e,r};Le.__=Ue;Le.uncurry=function(e){return e.fn};var xe=Object,ke=xe.create,Me=xe.getOwnPropertySymbols,He=xe.getPrototypeOf,Ge=xe.keys,ze=xe.propertyIsEnumerable,Fe=xe.prototype.toString,Be=Function.prototype.toString,$e=Array.isArray,Ve="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("react.element"):60103,We=function(e,t,r){for(var n=r,o=0;o<e.length;o++)n=t(n,e[o]);return n},Ye=function(e){var t=Me(e);return t.length?Ge(e).concat(We(t,(function(t,r){return ze.call(e,r)&&t.push(r),t}),[])):Ge(e)},qe="function"==typeof xe.assign?xe.assign:function(e,t){return t?We(Ye(t),(function(e,r){return e[r]=t[r],e}),Object(e)):e},Xe=function(e){return ke(e.__proto__||He(e))},Je=function(e){if(!e||"object"!=typeof e||e.$$typeof===Ve)return!1;var t=Fe.call(e);return"[object Date]"!==t&&"[object RegExp]"!==t},Ze=function(e){return null==e||$e(e)&&!e.length},Qe=function(e){return"function"==typeof e&&!!~Be.call(e).indexOf("[native code]")},et=function(e,t,r){return"function"==typeof e?e.apply(t,r):void 0},tt=function(e){return $e(e)?[]:{}},rt=function(e){return e.constructor===xe?qe({},e):$e(e)?function(e){for(var t=new e.constructor,r=0;r<e.length;r++)t[r]=e[r];return t}(e):Qe(e.constructor)?{}:qe(Xe(e),e)},nt=function(e,t){return e===t||e!=e&&t!=t},ot=function(e,t){return Je(e)?rt(e):function(e){return"number"==typeof e?[]:{}}(t)},it=function(e,t){return void 0===e?t:e},ct=function(e){return $e(e)?e:se(e)},ut=function(e,t,r,n){var o=e[n],i=n+1;return i===e.length?r(t,o):t[o]=ut(e,ot(t[o],e[i]),r,i),t},at=function(e,t,r){var n=ct(e),o=ot(t,n[0]);return 1===n.length?(r(o,n[0]),o):ut(n,o,r,0)},st=function(e,t,r){var n,o=$e(e);if(o!==$e(t)||!Je(e))return Je(n=t)?rt(n):n;if(o)return e.concat(t);var i=e.constructor===xe||Qe(e.constructor)?{}:Xe(e);return We(Ye(t),(function(n,o){return n[o]=r&&Je(t[o])?st(e[o],t[o],r):t[o],n}),qe(i,e))},ft=function(e,t,r){var n=ct(e);if(1===n.length)return t?it(t[n[0]],r):r;for(var o=t,i=n[0],c=0;c<n.length-1;c++){if(!o||!o[i])return r;o=o[i],i=n[c+1]}return o?it(o[i],r):r},lt=function(e,t,r){var n=Ze(e),o=n?t:r?r(ft(e,t)):ft(e,t);return $e(o)?$e(e)?e.concat([o.length]):(n?"":e)+"["+o.length+"]":e},dt=function(e,t){if(e.length){for(var r=e.length,n=t;n<r-1;)e[n]=e[n+1],++n;--e.length}},pt=function(){throw new TypeError('handler passed is not of type "function".')},ht=Array.isArray,yt=Array.prototype.slice,vt=function(e){return e?function(e,t,r,n,o){void 0===o&&(o=n),"function"!=typeof e&&pt();var i=yt.call(arguments,5);if(Ze(t))return et(e.apply(void 0,[n].concat(i)),o,r);var c=ft(t,n);if(void 0!==c){var u=e.apply(void 0,[c].concat(i));return et(u,o,r)}}:function(e,t,r,n){void 0===n&&(n=r);var o=Ze(e)?r:ft(e,r);return et(o,n,t)}},bt=function(e){return e?function(e,t,r){"function"!=typeof e&&pt();var n=yt.call(arguments,4);if(Ze(t))return e.apply(void 0,[r].concat(n));var o=ft(t,r);return void 0===o?o:e.apply(void 0,[o].concat(n))}:function(e,t){return Ze(e)?t:ft(e,t)}},gt=function(e){return e?function(e,t,r,n){"function"!=typeof e&&pt();var o=yt.call(arguments,4);if(Ze(r))return e.apply(void 0,[n].concat(o));var i=ft(r,n);return void 0===i?t:e.apply(void 0,[i].concat(o))}:function(e,t,r){return Ze(t)?r:ft(t,r,e)}},Et=function(e){return e?function(e,t,r){"function"!=typeof e&&pt();var n=yt.call(arguments,3);if(Ze(t))return!!e.apply(void 0,[r].concat(n));var o=ft(t,r);return void 0!==o&&!!e.apply(void 0,[o].concat(n))}:function(e,t){return Ze(e)?null!=t:void 0!==ft(e,t)}},mt=function(e){return e?function(e,t,r,n){"function"!=typeof e&&pt();var o=yt.call(arguments,4);return Ze(t)?nt(e.apply(void 0,[n].concat(o)),r):nt(e.apply(void 0,[ft(t,n)].concat(o)),r)}:function(e,t,r){return Ze(e)?nt(r,t):nt(ft(e,r),t)}},Ot=function(e,t){return e?function(e,r,n){"function"!=typeof e&&pt();var o=yt.call(arguments,3);if(!Je(n))return e.apply(void 0,[n].concat(o));if(Ze(r)){var i=e.apply(void 0,[n].concat(o));return i?st(n,i,t):n}var c=!1,u=at(r,n,(function(r,n){var i=e.apply(void 0,[r[n]].concat(o));i&&(r[n]=st(r[n],i,t),c=!0)}));return c?u:n}:function(e,r,n){return Je(n)?Ze(e)?st(n,r,!0):at(e,n,(function(e,n){e[n]=st(e[n],r,t)})):r}},wt=function(e){var t=mt(e);return function(){return!t.apply(this,arguments)}},_t=function(e){return e?function(e,t,r){"function"!=typeof e&&pt();var n=yt.call(arguments,3);if(Ze(t)){var o=tt(r);return e.apply(void 0,[o].concat(n))?o:r}var i=ft(t,r);return void 0!==i&&e.apply(void 0,[i].concat(n))?at(t,r,(function(e,t){ht(e)?dt(e,t):delete e[t]})):r}:function(e,t){return Ze(e)?tt(t):void 0!==ft(e,t)?at(e,t,(function(e,t){ht(e)?dt(e,t):delete e[t]})):t}},St=function(e){return e?function(e,t,r){"function"!=typeof e&&pt();var n=yt.call(arguments,3);return Ze(t)?e.apply(void 0,[r].concat(n)):at(t,r,(function(t,r){t[r]=e.apply(void 0,[t[r]].concat(n))}))}:function(e,t,r){return Ze(e)?t:at(e,r,(function(e,r){e[r]=t}))}},Tt=function(e){var t=St(e);return e?function(e,r,n){return t.apply(this,[e,lt(r,n,e),n].concat(yt.call(arguments,3)))}:function(e,r,n){return t(lt(e,n),r,n)}},It=(Le(Tt(!1),3),Le(Tt(!0),3),Le(Ot(!1,!1),3),Le(Ot(!0,!1),3),Le(vt(!1),3),Le(vt(!0),4),Le(bt(!1),2),Le(gt(!1),3),Le(bt(!0),3),Le(gt(!0),4),Le(Et(!1),2),Le(Et(!0),3),Le(mt(!1),3),Le(mt(!0),4),Le(Ot(!1,!0),3),Le(Ot(!0,!0),3),Le(wt(!1),3),Le(wt(!0),4),Le(_t(!1),2),Le(_t(!0),3),Le(St(!1),3),Le(St(!0),3),"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{});function At(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function Nt(e,t){return e(t={exports:{}},t.exports),t.exports}var Dt=function(){return Math.random().toString(36).substring(7).split("").join(".")},jt={INIT:"@@redux/INIT"+Dt(),REPLACE:"@@redux/REPLACE"+Dt(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Dt()}};function Ct(e,t){var r=t&&t.type;return"Given "+(r&&'action "'+String(r)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function Pt(e,t){return function(){return t(e.apply(this,arguments))}}function Rt(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ut(e,t){var r=Object.keys(e);return Object.getOwnPropertySymbols&&r.push.apply(r,Object.getOwnPropertySymbols(e)),t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r}function Kt(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ut(r,!0).forEach((function(t){Rt(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ut(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Lt(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}var xt,kt=(xt=Object.freeze({__proto__:null,__DO_NOT_USE__ActionTypes:jt,applyMiddleware:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return function(e){return function(){var r=e.apply(void 0,arguments),n=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:r.getState,dispatch:function(){return n.apply(void 0,arguments)}},i=t.map((function(e){return e(o)}));return Kt({},r,{dispatch:n=Lt.apply(void 0,i)(r.dispatch)})}}},bindActionCreators:function(e,t){if("function"==typeof e)return Pt(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');var r={};for(var n in e){var o=e[n];"function"==typeof o&&(r[n]=Pt(o,t))}return r},combineReducers:function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++){var o=t[n];"function"==typeof e[o]&&(r[o]=e[o])}var i,c=Object.keys(r);try{!function(e){Object.keys(e).forEach((function(t){var r=e[t];if(void 0===r(void 0,{type:jt.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if(void 0===r(void 0,{type:jt.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+jt.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')}))}(r)}catch(e){i=e}return function(e,t){if(void 0===e&&(e={}),i)throw i;for(var n=!1,o={},u=0;u<c.length;u++){var a=c[u],s=r[a],f=e[a],l=s(f,t);if(void 0===l){var d=Ct(a,t);throw new Error(d)}o[a]=l,n=n||l!==f}return n?o:e}},compose:Lt,createStore:function e(t,n,o){var i;if("function"==typeof n&&"function"==typeof o||"function"==typeof o&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof n&&void 0===o&&(o=n,n=void 0),void 0!==o){if("function"!=typeof o)throw new Error("Expected the enhancer to be a function.");return o(e)(t,n)}if("function"!=typeof t)throw new Error("Expected the reducer to be a function.");var c=t,u=n,a=[],s=a,f=!1;function l(){s===a&&(s=a.slice())}function d(){if(f)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function p(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(f)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return l(),s.push(e),function(){if(t){if(f)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,l();var r=s.indexOf(e);s.splice(r,1)}}}function h(e){if(!function(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(f)throw new Error("Reducers may not dispatch actions.");try{f=!0,u=c(u,e)}finally{f=!1}for(var t=a=s,r=0;r<t.length;r++){(0,t[r])()}return e}return h({type:jt.INIT}),(i={dispatch:h,subscribe:p,getState:d,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");c=e,h({type:jt.REPLACE})}})[r]=function(){var e,t=p;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function r(){e.next&&e.next(d())}return r(),{unsubscribe:t(r)}}})[r]=function(){return this},e},i}}))&&xt.default||xt,Mt=Nt((function(e,t){var r=kt.compose;t.__esModule=!0,t.composeWithDevTools="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?r:r.apply(null,arguments)},t.devToolsEnhancer="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__?window.__REDUX_DEVTOOLS_EXTENSION__:function(){return function(e){return e}}}));At(Mt);var Ht=Mt.composeWithDevTools;Mt.devToolsEnhancer;function Gt(e){return function(t){var r=t.dispatch,n=t.getState;return function(t){return function(o){return"function"==typeof o?o(r,n,e):t(o)}}}}var zt=Gt();function Ft(e){return(Ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Bt(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}zt.withExtraArgument=Gt;var $t=!0;function Vt(e,t){return e?"".concat(e,"/").concat(t):t}function Wt(e){var t=e.slice,r=void 0===t?"":t,n=e.initialState,o=e.reducers||{},i=e.extraReducers||{},c=Object.keys(o),u=function(e,t){return function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e,n=arguments.length>1?arguments[1]:void 0;return te(r,(function(e){var r=t[n.type];return r?r(e,n):void 0}))}}(n,c.reduce((function(e,t){return e[Vt(r,t)]=o[t],e}),i)),a=c.reduce((function(e,t){var n=Vt(r,t);return e[t]=function(e){function t(t){return{type:e,payload:t}}return t.toString=function(){return"".concat(e)},t.type=e,t}(n),e}),{}),s=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}({},function(e){return e?"get ".concat(e).replace(/(?:^\w|[A-Z]|\b\w)/g,(function(e,t){return 0===t?e.toLowerCase():e.toUpperCase()})).replace(/\s+/g,"").replace(/[-_]/g,""):"getState"}(r),function(e){return e?function(t){return t[e]}:function(e){return e}}(r));return{slice:r,reducer:u,actions:a,selectors:s}}let Yt=!1;"object"==typeof process&&"object"==typeof process.versions&&(void 0!==process.versions.node?(Yt=!0,console.log("Running in node.js")):console.log("Running in browser"));const qt=Yt;function Xt(e){const t=e.replace(/-/g,"+").replace(/_/g,"/");let r=t;switch(r.length%4){case 0:case 2:r+="==";break;case 3:r+="=";break;default:throw new Error("Illegal base64url string!")}let n="",o=e=>(console.error("Invalid atob for string ",e),"invalid atob");if(Yt){o=e=>{return Buffer.from(e,"base64").toString("binary")}}else o=window.atob;try{n=o(t)}catch(e){try{n=o(r)}catch(e){console.error("urlBase64Decode: trying atob failed")}}return n}const Jt=["91 30 CF 20 17 F7 D7 EC F7 BA 43 30 8E 19 83 B4 CF DE 5A CC","26 B0 20 FA AB E8 A3 81 63 37 C6 B7 EF 94 4D 40 3D 1B 85 10"],Zt="https://testapi.cozify.fi",Qt="ui/0.2/";let er="https://api.cozify.fi";function tr(){return`${er}/${Qt}`}const rr="1.13",nr=Object.freeze({USER_LOGIN:{method:"POST",url:"user/login",params:["password","email"],config:{responseType:qt?"blob":"stream",timeout:15e3}},HUB_KEYS:{method:"GET",url:"user/hubkeys",timeout:15e3},REFRESH_AUTHKEY:{method:"GET",url:"user/refreshsession"},CLOUD_IP:{method:"GET",url:"hub/lan_ip"},CLOUD_META:{method:"GET",url:"hub/remote/hub"},POLL:{method:"GET",url:"hub/remote/cc/$API_VER/hub/poll",urlParams:["ts"]},PAIR_START:{method:"GET",url:"hub/remote/cc/$API_VER/hub/scan",urlParams:["ts"]},PAIR_IGNORE:{method:"PUT",url:"hub/remote/cc/$API_VER/hub/scan",type:"SET_SCAN_RESULT",params:["id","ignored"]},PAIR_STOP:{method:"GET",url:"hub/remote/cc/$API_VER/hub/stopscan"},CMD_DEVICE_STATE:{method:"PUT",url:"hub/remote/cc/$API_VER/devices/command",type:"CMD_DEVICE",params:["id","state"]},CMD_DEVICE_IGNORE:{method:"PUT",url:"hub/remote/cc/$API_VER/devices/command",type:"CMD_IGNORE_DEVICE",params:["id"]},CMD_DEVICE_IDENTIFY:{method:"PUT",url:"hub/remote/cc/$API_VER/devices/command",type:"CMD_IDENTIFY",params:["id"]},CMD_DEVICE_META:{method:"PUT",url:"hub/remote/cc/$API_VER/devices/command",type:"CMD_DEVICE_META",params:["id","name","room"]},CMD_GET_ROOMS:{method:"GET",url:"hub/remote/cc/$API_VER/rooms"},CMD_SET_ROOM:{method:"PUT",url:"hub/remote/cc/$API_VER/rooms",type:"CMD_ROOM",params:["id","name","order"]},CMD_REMOVE_ROOM:{method:"DELETE",url:"hub/remote/cc/$API_VER/rooms",urlParams:["roomId"]}}),or=Object.freeze({UNCONNECTED:"no connection",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",OBSOLETE_API_VERSION:"obsolete api version",LATE_PAYMENT:"late payment",CONNECTED:"connected"}),ir=Object.freeze({UNCONNECTED:"no connection",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",OBSOLETE_API_VERSION:"obsolete api version",REMOTE:"remote",LOCAL:"local"}),cr=Wt({slice:"connections",initialState:{cloudState:or.UNCONNECTED},reducers:{setCloudConnectionState(e,t){const r=e,n=t.payload,o=e.cloudState;Object.values(or).indexOf(n)>-1&&o!==n&&(console.log(`CLOUD connection state ${o} -> ${n}`),r.cloudState=n)}}}),{actions:ur,reducer:ar}=cr;var sr=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e};function fr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fr(r,!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fr(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const dr=Wt({slice:"pairings",initialState:{},reducers:{setPairingDevices(e,t){const r=e,{hubId:n}=t.payload,{devices:o}=t.payload,i={};Object.entries(o).forEach(e=>{const[t,r]=e;i[t]=lr({},r)}),r[n]=lr({},i)},setPairingDevice(e,t){const r=e,{hubId:n}=t.payload,{device:o}=t.payload;r[n]&&(r[n][o.id]=lr({},o))},deletePairingDevice(e,t){const r=e,{hubId:n}=t.payload,{deviceId:o}=t.payload;n&&o&&r[n]&&r[n][o]&&delete r[n][o]}}}),{actions:pr,reducer:hr}=dr;function yr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function vr(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?yr(r,!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):yr(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const br=Wt({slice:"devices",initialState:{},reducers:{setDevices(e,t){const r=e,{hubId:n}=t.payload,{devices:o}=t.payload,i={};Object.entries(o).forEach(e=>{const[t,r]=e;i[t]=vr({},r)}),r[n]=vr({},i)},setDevice(e,t){const r=e,{hubId:n}=t.payload,{device:o}=t.payload;r[n]&&(r[n][o.id]=vr({},o))},deleteDevice(e,t){const r=e,{hubId:n}=t.payload,{deviceId:o}=t.payload;n&&o&&r[n]&&r[n][o]&&delete r[n][o]}}}),{actions:gr,reducer:Er}=br,{setDevices:mr,deleteDevice:Or}=gr;function wr(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}const _r=Wt({slice:"hubs",initialState:{},reducers:{updateHubs(e,t){const r=e,n=t.payload;console.log("updateHubs",n),Object.entries(n).forEach(t=>{const[n,o]=t;r[n]=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wr(r,!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wr(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e[n],{},o)})},selectHub(e,t){const r=e,{hubId:n}=t.payload;console.log("selectHub",n),e[n]&&(r[n].selected=!0,console.log("selectHub",e[n]))},unSelectHub(e,t){const r=e,{hubId:n}=t.payload;e[n]&&(r[n].selected=!1)},setHubConnectionState(e,t){const{hubId:r}=t.payload,n=e,o=t.payload.state,i=e[r]?e[r].connectionState:void 0;Object.values(ir).indexOf(o)>-1&&i&&i!==o&&(n[r].connectionState=o)}}}),{actions:Sr,reducer:Tr}=_r,{updateHubs:Ir,selectHub:Ar,unSelectHub:Nr,setHubConnectionState:Dr}=Sr;var jr=Object.prototype;var Cr=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||jr)};var Pr=function(e,t){return function(r){return e(t(r))}}(Object.keys,Object),Rr=Object.prototype.hasOwnProperty;var Ur=function(e){if(!Cr(e))return Pr(e);var t=[];for(var r in Object(e))Rr.call(e,r)&&"constructor"!=r&&t.push(r);return t},Kr="object"==typeof It&&It&&It.Object===Object&&It,Lr="object"==typeof self&&self&&self.Object===Object&&self,xr=Kr||Lr||Function("return this")(),kr=xr.Symbol,Mr=Object.prototype,Hr=Mr.hasOwnProperty,Gr=Mr.toString,zr=kr?kr.toStringTag:void 0;var Fr=function(e){var t=Hr.call(e,zr),r=e[zr];try{e[zr]=void 0;var n=!0}catch(e){}var o=Gr.call(e);return n&&(t?e[zr]=r:delete e[zr]),o},Br=Object.prototype.toString;var $r=function(e){return Br.call(e)},Vr="[object Null]",Wr="[object Undefined]",Yr=kr?kr.toStringTag:void 0;var qr=function(e){return null==e?void 0===e?Wr:Vr:Yr&&Yr in Object(e)?Fr(e):$r(e)};var Xr=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},Jr="[object AsyncFunction]",Zr="[object Function]",Qr="[object GeneratorFunction]",en="[object Proxy]";var tn,rn=function(e){if(!Xr(e))return!1;var t=qr(e);return t==Zr||t==Qr||t==Jr||t==en},nn=xr["__core-js_shared__"],on=(tn=/[^.]+$/.exec(nn&&nn.keys&&nn.keys.IE_PROTO||""))?"Symbol(src)_1."+tn:"";var cn=function(e){return!!on&&on in e},un=Function.prototype.toString;var an=function(e){if(null!=e){try{return un.call(e)}catch(e){}try{return e+""}catch(e){}}return""},sn=/^\[object .+?Constructor\]$/,fn=Function.prototype,ln=Object.prototype,dn=fn.toString,pn=ln.hasOwnProperty,hn=RegExp("^"+dn.call(pn).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var yn=function(e){return!(!Xr(e)||cn(e))&&(rn(e)?hn:sn).test(an(e))};var vn=function(e,t){return null==e?void 0:e[t]};var bn=function(e,t){var r=vn(e,t);return yn(r)?r:void 0},gn=bn(xr,"DataView"),En=bn(xr,"Map"),mn=bn(xr,"Promise"),On=bn(xr,"Set"),wn=bn(xr,"WeakMap"),_n=an(gn),Sn=an(En),Tn=an(mn),In=an(On),An=an(wn),Nn=qr;(gn&&"[object DataView]"!=Nn(new gn(new ArrayBuffer(1)))||En&&"[object Map]"!=Nn(new En)||mn&&"[object Promise]"!=Nn(mn.resolve())||On&&"[object Set]"!=Nn(new On)||wn&&"[object WeakMap]"!=Nn(new wn))&&(Nn=function(e){var t=qr(e),r="[object Object]"==t?e.constructor:void 0,n=r?an(r):"";if(n)switch(n){case _n:return"[object DataView]";case Sn:return"[object Map]";case Tn:return"[object Promise]";case In:return"[object Set]";case An:return"[object WeakMap]"}return t});var Dn=Nn;var jn=function(e){return null!=e&&"object"==typeof e},Cn="[object Arguments]";var Pn=function(e){return jn(e)&&qr(e)==Cn},Rn=Object.prototype,Un=Rn.hasOwnProperty,Kn=Rn.propertyIsEnumerable,Ln=Pn(function(){return arguments}())?Pn:function(e){return jn(e)&&Un.call(e,"callee")&&!Kn.call(e,"callee")},xn=Array.isArray,kn=9007199254740991;var Mn=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=kn};var Hn=function(e){return null!=e&&Mn(e.length)&&!rn(e)};var Gn=function(){return!1},zn=Nt((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r?xr.Buffer:void 0,i=(o?o.isBuffer:void 0)||Gn;e.exports=i})),Fn={};Fn["[object Float32Array]"]=Fn["[object Float64Array]"]=Fn["[object Int8Array]"]=Fn["[object Int16Array]"]=Fn["[object Int32Array]"]=Fn["[object Uint8Array]"]=Fn["[object Uint8ClampedArray]"]=Fn["[object Uint16Array]"]=Fn["[object Uint32Array]"]=!0,Fn["[object Arguments]"]=Fn["[object Array]"]=Fn["[object ArrayBuffer]"]=Fn["[object Boolean]"]=Fn["[object DataView]"]=Fn["[object Date]"]=Fn["[object Error]"]=Fn["[object Function]"]=Fn["[object Map]"]=Fn["[object Number]"]=Fn["[object Object]"]=Fn["[object RegExp]"]=Fn["[object Set]"]=Fn["[object String]"]=Fn["[object WeakMap]"]=!1;var Bn=function(e){return jn(e)&&Mn(e.length)&&!!Fn[qr(e)]};var $n=function(e){return function(t){return e(t)}},Vn=Nt((function(e,t){var r=t&&!t.nodeType&&t,n=r&&e&&!e.nodeType&&e,o=n&&n.exports===r&&Kr.process,i=function(){try{var e=n&&n.require&&n.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i})),Wn=Vn&&Vn.isTypedArray,Yn=Wn?$n(Wn):Bn,qn="[object Map]",Xn="[object Set]",Jn=Object.prototype.hasOwnProperty;var Zn=function(e){if(null==e)return!0;if(Hn(e)&&(xn(e)||"string"==typeof e||"function"==typeof e.splice||zn(e)||Yn(e)||Ln(e)))return!e.length;var t=Dn(e);if(t==qn||t==Xn)return!e.size;if(Cr(e))return!Ur(e).length;for(var r in e)if(Jn.call(e,r))return!1;return!0};const Qn=Object.freeze({NONE:"none",EN_EN:"en",EN_UK:"en-UK",FI_FI:"fi-FI",FI:"fi",EN:"en"}),eo=Object.freeze({WAITING_LANGUAGE:"wait language",LANGUAGE_SET:"language set",WAITING_LOGIN:"wait login",LOGIN_DONE:"login done",WAITING_EULA:"wait eula",EULA_ACCEPTED:"eula accepted",AUTHENTICATED:"logged in",KEYED:"key entered",LOGGED_OUT:"logged out"}),to=Object.freeze({ADMIN:32,USER:8,GUEST:2,ANONYMOUS:1}),ro=Wt({slice:"user",initialState:{firstName:"",lastName:"",email:"",language:Qn.NONE,authKey:"",role:to.ANONYMOUS,eulaAccepted:!1,state:eo.WAITING_LANGUAGE},reducers:{changeState(e,t){const r=e,n=t.payload,o=e.state;switch(console.log(`User state ${o} -> ${n}`),o){case eo.WAITING_LANGUAGE:n===eo.LANGUAGE_SET&&(Zn(e.language)||(r.state=eo.WAITING_LOGIN));break;case eo.WAITING_LOGIN:n===eo.LOGIN_DONE&&(Zn(e.authKey)||(Zn(e.eulaAcceted)?r.state=eo.WAITING_EULA:r.state=eo.AUTHENTICATED));break;case eo.WAITING_EULA:n===eo.EULA_ACCEPTED&&(r.state=eo.AUTHENTICATED);break;case eo.AUTHENTICATED:n===eo.LOGGED_OUT&&(r.state=eo.WAITING_LOGIN)}},setEula(e,t){e.eulaAccepted=t.payload},setLanguage(e,t){e.language=t.payload},setAuthKey(e,t){e.authKey=t.payload},setAuthenticated(e,t){const r=e;r.authKey=t.payload,r.state=eo.KEYED}}}),{actions:no,reducer:oo}=ro;function io(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function co(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?io(r,!0).forEach((function(t){sr(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):io(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const uo=Wt({slice:"rooms",initialState:{},reducers:{setRooms(e,t){const r=e,{hubId:n}=t.payload,{rooms:o}=t.payload,i={};Object.entries(o).forEach(e=>{const[t,r]=e;i[t]=co({},r)}),r[n]=co({},i)},setRoom(e,t){const r=e,{hubId:n}=t.payload,{room:o}=t.payload;n&&r[n]&&(r[n][o.id]=co({},o))},removeRoom(e,t){const r=e,{hubId:n}=t.payload,{roomId:o}=t.payload;n&&o&&r[n]&&r[n][o]&&delete r[n][o]},editRoom(e,t){const r=e,{hubId:n}=t.payload,{room:o}=t.payload;r[n]&&(r[n][o.id]=co({},o))}}}),{actions:ao,reducer:so}=uo,fo={connections:ar,pairings:hr,devices:Er,hubs:Tr,user:oo,rooms:so};
/*!
	 * isobject <https://github.com/jonschlinkert/isobject>
	 *
	 * Copyright (c) 2014-2017, Jon Schlinkert.
	 * Released under the MIT License.
	 */
var lo=function(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)},po=function(e,t,r){if(lo(r)||(r={default:r}),!vo(e))return void 0!==r.default?r.default:e;"number"==typeof t&&(t=String(t));const n=Array.isArray(t),o="string"==typeof t,i=r.separator||".",c=r.joinChar||("string"==typeof i?i:".");if(!o&&!n)return e;if(o&&t in e)return yo(t,e,r)?e[t]:r.default;let u=n?t:function(e,t,r){if("function"==typeof r.split)return r.split(e);return e.split(t)}(t,i,r),a=u.length,s=0;do{let t=u[s];for("number"==typeof t&&(t=String(t));t&&"\\"===t.slice(-1);)t=ho([t.slice(0,-1),u[++s]||""],c,r);if(t in e){if(!yo(t,e,r))return r.default;e=e[t]}else{let n=!1,o=s+1;for(;o<a;)if(n=(t=ho([t,u[o++]],c,r))in e){if(!yo(t,e,r))return r.default;e=e[t],s=o-1;break}if(!n)return r.default}}while(++s<a&&vo(e));return s===a?e:r.default};
/*!
	 * get-value <https://github.com/jonschlinkert/get-value>
	 *
	 * Copyright (c) 2014-2018, Jon Schlinkert.
	 * Released under the MIT License.
	 */function ho(e,t,r){return"function"==typeof r.join?r.join(e):e[0]+t+e[1]}function yo(e,t,r){return"function"!=typeof r.isValid||r.isValid(e,t)}function vo(e){return lo(e)||Array.isArray(e)||"function"==typeof e}const bo=function(e){var t,r=e||{},n=r.reducer,o=void 0===n?void 0:n,c=r.middleware,a=void 0===c?[zt]:c,s=r.devTools,d=void 0===s||s,p=r.preloadedState,h=void 0===p?void 0:p,y=r.enhancers,v=void 0===y?[]:y;if("function"==typeof o)t=o;else{if(!function(e){if("object"!==Ft(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}(o))throw new Error("Reducer argument must be a function or an object of functions that can be passed to combineReducers");t=u(o)}var b=l.apply(void 0,Bt(a)),g=f;d&&(g=Ht({trace:!$t}));var E=[b].concat(Bt(v));return i(t,h,g.apply(void 0,Bt(E)))}({reducer:fo});function go(e,t,r){const n=r||bo,o=function(e,t){let r=po(e(),t);return function(n){return()=>{const o=po(e(),t);if(r!==o){const e=r;r=o,n(o,e)}}}}(n.getState,e);n.subscribe(o(t))}console.log("Store Initial State: ",bo.getState());const Eo=Object.freeze({UNCLAIMED:"unclaimed",CLAIMED:"claimed",TOO_NEW_VERSION:"new version",NO_ACCESS:"no access",CONNECTED:"connected"}),mo=45e3,Oo=1e3,wo=5e3,_o="http://",So="8893";function To(e){bo.dispatch(cr.actions.setCloudConnectionState(e))}function Io(e){const t=bo.getState(),r=_r.selectors.getHubs(t),n=e;n.state===ir.UNCONNECTED&&r[n.hubId]&&r[n.hubId].connectionState===ir.REMOTE&&(n.state=ir.LOCAL),bo.dispatch(_r.actions.setHubConnectionState(n))}var Ao="[object String]";var No=function(e){return"string"==typeof e||!xn(e)&&jn(e)&&qr(e)==Ao},Do=["ETIMEDOUT","ECONNRESET","EADDRINUSE","ESOCKETTIMEDOUT","ECONNREFUSED","EPIPE","EHOSTUNREACH","EAI_AGAIN"],jo=["ENOTFOUND","ENETUNREACH","UNABLE_TO_GET_ISSUER_CERT","UNABLE_TO_GET_CRL","UNABLE_TO_DECRYPT_CERT_SIGNATURE","UNABLE_TO_DECRYPT_CRL_SIGNATURE","UNABLE_TO_DECODE_ISSUER_PUBLIC_KEY","CERT_SIGNATURE_FAILURE","CRL_SIGNATURE_FAILURE","CERT_NOT_YET_VALID","CERT_HAS_EXPIRED","CRL_NOT_YET_VALID","CRL_HAS_EXPIRED","ERROR_IN_CERT_NOT_BEFORE_FIELD","ERROR_IN_CERT_NOT_AFTER_FIELD","ERROR_IN_CRL_LAST_UPDATE_FIELD","ERROR_IN_CRL_NEXT_UPDATE_FIELD","OUT_OF_MEM","DEPTH_ZERO_SELF_SIGNED_CERT","SELF_SIGNED_CERT_IN_CHAIN","UNABLE_TO_GET_ISSUER_CERT_LOCALLY","UNABLE_TO_VERIFY_LEAF_SIGNATURE","CERT_CHAIN_TOO_LONG","CERT_REVOKED","INVALID_CA","PATH_LENGTH_EXCEEDED","INVALID_PURPOSE","CERT_UNTRUSTED","CERT_REJECTED"],Co=function(e){return!e||!e.code||(-1!==Do.indexOf(e.code)||-1===jo.indexOf(e.code))},Po=Nt((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isNetworkError=o,t.isRetryableError=u,t.isSafeRequestError=a,t.isIdempotentRequestError=s,t.isNetworkOrIdempotentRequestError=f,t.exponentialDelay=d,t.default=h;var r=function(e){return e&&e.__esModule?e:{default:e}}(Co);var n="axios-retry";function o(e){return!e.response&&Boolean(e.code)&&"ECONNABORTED"!==e.code&&(0,r.default)(e)}var i=["get","head","options"],c=i.concat(["put","delete"]);function u(e){return"ECONNABORTED"!==e.code&&(!e.response||e.response.status>=500&&e.response.status<=599)}function a(e){return!!e.config&&(u(e)&&-1!==i.indexOf(e.config.method))}function s(e){return!!e.config&&(u(e)&&-1!==c.indexOf(e.config.method))}function f(e){return o(e)||s(e)}function l(){return 0}function d(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=100*Math.pow(2,e);return t+.2*t*Math.random()}function p(e){var t=e[n]||{};return t.retryCount=t.retryCount||0,e[n]=t,t}function h(e,t){e.interceptors.request.use((function(e){return p(e).lastRequestTime=Date.now(),e})),e.interceptors.response.use(null,(function(r){var o=r.config;if(!o)return Promise.reject(r);var i=function(e,t){return Object.assign({},t,e[n])}(o,t),c=i.retries,u=void 0===c?3:c,a=i.retryCondition,s=void 0===a?f:a,d=i.retryDelay,h=void 0===d?l:d,y=i.shouldResetTimeout,v=void 0!==y&&y,b=p(o);if(s(r)&&b.retryCount<u){b.retryCount+=1;var g=h(b.retryCount,r);if(function(e,t){e.defaults.agent===t.agent&&delete t.agent,e.defaults.httpAgent===t.httpAgent&&delete t.httpAgent,e.defaults.httpsAgent===t.httpsAgent&&delete t.httpsAgent}(e,o),!v&&o.timeout&&b.lastRequestTime){var E=Date.now()-b.lastRequestTime;o.timeout=Math.max(o.timeout-E-g,1)}return o.transformRequest=[function(e){return e}],new Promise((function(t){return setTimeout((function(){return t(e(o))}),g)}))}return Promise.reject(r)}))}h.isNetworkError=o,h.isSafeRequestError=a,h.isIdempotentRequestError=s,h.isNetworkOrIdempotentRequestError=f,h.exponentialDelay=d,h.isRetryableError=u}));At(Po);Po.isNetworkError,Po.isRetryableError,Po.isSafeRequestError,Po.isIdempotentRequestError,Po.isNetworkOrIdempotentRequestError,Po.exponentialDelay;var Ro=Po.default;const Uo=36e5;function Ko(e,t){let r="0.0";const n=e.indexOf(".");let o=-1;return-1!==n&&(o=e.indexOf(".",n+1)),-1!==o&&(r=e.substring(0,o)),function(e,t){const r=e.split("."),n=t.split("."),o=Math.min(r.length,n.length);if(o>0)for(let e=0;e<o-1;e+=1){const t=Number(r[e])-Number(n[e]);if(0!==t)return t}return r.length-n.length}(r,t)>0&&(r=t),r}function Lo(e){let t=or.UNCONNECTED;return e&&e.response&&401===e.response.status?(t=or.UNAUTHENTICATED,console.error("send: authentication error ",e)):e&&e.response&&403===e.response.status?(t=or.LATE_PAYMENT,console.error("send: unauhorized error ",e)):e&&e.response&&403===e.response.status?(t=or.UNAUTHORIZED,console.error("send: unauhorized error ",e)):e&&e.response&&410===e.response.status&&(t=or.OBSOLETE_API_VERSION,console.error("send: version error ",e)),t}function xo(e){let t=ir.UNCONNECTED;return e&&e.response&&400===e.response.status?console.log("send: no-connection error ",e):e&&e.response&&401===e.response.status?(t=ir.UNAUTHENTICATED,console.error("send: authentication error ",e)):e&&e.response&&403===e.response.status?(t=ir.UNAUTHORIZED,console.error("send: unauhorized error ",e)):e&&e.response&&410===e.response.status&&(t=ir.OBSOLETE_API_VERSION,console.error("send: version error ",e)),t}let ko=!1,Mo=null;function Ho(e){return new Promise(t=>{if(!e)return void t(!0);const r=(new Date).getTime();ko||Mo&&!(r-Mo>Uo)?t(!0):(ko=!0,Mo=r,!qt&&window&&window.plugins&&window.plugins.sslCertificateChecker?window.plugins.sslCertificateChecker.check(()=>{ko=!1,t(!0)},e=>{"CONNECTION_NOT_SECURE"===e?(ko=!1,t(!1)):(ko=!1,Mo=void 0,t(!0))},er,Jt):(setTimeout(()=>{ko=!1},Uo),t(!0)))})}const Go=["get","head","options"].concat(["put","delete"]),zo=Go.concat(["post"]);function Fo(e){return!!e.config&&(function(e){return!e.response||e.response.status>=500&&e.response.status<=599}(e)&&-1!==zo.indexOf(e.config.method))}const Bo={},$o=2;let Vo=!1;function Wo(e){let t=null,r={},n={},o=null;if(e){const t=e.split(".");r=JSON.parse(Xt(t[0])),n=JSON.parse(Xt(t[1]))}var i;(r&&r.exp||null!=n&&n.exp)&&(t=r.exp?r.exp:n.exp),t&&(o=t-Math.round((new Date).getTime()/1e3)),!o||o<0?To(or.UNAUTHENTICATED):o&&o<432e3&&(i=e,Vo||(Vo=!0,Xo({command:nr.REFRESH_AUTHKEY,authKey:i}).then(e=>{setTimeout(()=>{Vo=!1},6e5),e.length>10&&bo.dispatch(ro.actions.setAuthKey(e))}).catch(()=>{Vo=!1})))}function Yo(e){return new Promise(t=>{Promise.all(e).then(()=>{t()}).catch(()=>{t()})})}Ro(t,{retryCondition:function(e){if(!(e&&e.config&&e.config.url))return console.error("retryCondition unknown",e),!1;if(Bo[e.config.url]){if(Bo[e.config.url]>=$o)return Bo[e.config.url]=0,console.error("retryCondition count >",$o),!1;Bo[e.config.url]+=Bo[e.config.url],console.info("retryCondition count set ",Bo[e.config.url])}else Bo[e.config.url]=1,console.info("retryCondition count set to 1");Fo(e)&&-1!==Go.indexOf(e.config.method)?console.info("retryCondition condition true",e.config):(console.info("retryCondition condition false",e.config),Bo[e.config.url]=0);const t=Fo(e)&&-1!==Go.indexOf(e.config.method);return console.info("retryCondition return ",t),t},shouldResetTimeout:!0,retryDelay:(e,t)=>(console.error("axiosRetry ",t),5e3)});let qo=!1;function Xo({command:e,localUrl:r,url:n,timeout:o,method:i,authKey:c,hubKey:u,type:a,config:s,data:f,hubId:l}){let d=i,p=n,h=o,y=c,v=u,b=s,g=a;null==d&&(d="GET"),null==g&&(g="application/json;charset=UTF-8");const E=f;let m=!1;const O=!Zn(l),w=bo.getState(),_=ro.selectors.getUser(w);if(void 0!==e&&e){if(e.method&&(d=e.method),Zn(p)&&e.url)if(-1!==e.url.indexOf("$API_VER")){const t=_r.selectors.getHubs(w);if(!t[l]||!t[l].hubKey)return new Promise((e,t)=>{t(new Error("SDK Error: Send - Hub or hubKey not found error"))});const r=t[l];if(!r.version||r.connectionState===ir.UNCONNECTED&&-1===e.url.indexOf("hub/remote/hub"))return new Promise((e,t)=>{t(new Error("SDK Error: Send - No Hub connection error"))});const n=Ko(r.version,rr);p=tr().concat(e.url.replace("$API_VER",n))}else p=tr().concat(e.url);if(p){const e=p.split("hub/remote");e&&e[1]&&r&&(p=r+e[1],v&&(y=v,v=null))}if(p&&p.indexOf(tr())>-1&&(m=!0),e.type&&E&&(xn(E)?E[0]&&(E[0].type=e.type):E&&(E.type=e.type)),e.params&&(e.params.includes("type")||e.params.push("type"),e.params.forEach(e=>{xn(f)?E&&E[0]&&f&&f[0]&&(E[0][e]=f[0][e]):E&&f&&(E[e]=f[e])})),e.urlParams){const t=[];e.urlParams.forEach(e=>{f&&void 0!==f[e]&&t.push(`${encodeURIComponent(e)}=${encodeURIComponent(f[e])}`)}),p&&t.length>0&&(p=`${p}?${t.join("&")}`)}e.timeout&&(h=e.timeout),e.config&&(b=e.config)}const S=JSON.stringify(E),T={timeout:h||15e3,method:d,headers:{Accept:"application/json, application/binary, text/plain, */*","Content-Type":g,Authorization:y||null,"X-Hub-Key":v||null,"Accept-Language":_.language&&_.language!==Qn.NONE?_.language:null},crossDomain:!0,responseType:"application/json",url:p,data:Zn(S)?null:S};return Object.assign(T,b),new Promise((r,n)=>{e||p?(t.interceptors.response.use(e=>e.headers["content-type"].includes("application/json")||e.headers["content-type"].includes("application/binary")?(function(e){Bo[e]&&(console.warn("resetRetry to 0"),Bo[e]=0,delete Bo[e])}(p),e):(console.error("send: unknown response type"),e),e=>Promise.reject(e)),Ho(m).then(o=>{!o||qo?(qo=!0,n(new Error("SDK Error: SSL failure."))):(y&&Wo(y),t(T).then(e=>{m?To(or.CONNECTED):l&&Io({hubId:l,state:ir.LOCAL}),r(e.data)}).catch(t=>{let r="SDK Send error:";t&&t.response?(t.response.data&&t.response.data.message&&(r=r.concat(t.response.data.message)),t.response.status&&(r=r.concat(`Status: ${t.response.status}`)),m?(e!==nr.CLOUD_META&&To(Lo(t)),O&&l&&Io({hubId:l,state:xo(t)})):(t&&t.response&&401===t.response.status&&To(Lo(t)),O&&l&&Io({hubId:l,state:xo(t)}))):t.request?m?(To(or.UNCONNECTED),O&&l&&Io({hubId:l,state:ir.UNCONNECTED}),r=r.concat(`Cloud unconnected in remote. Status ${t.request.status}`)):O&&l&&(Io({hubId:l,state:ir.UNCONNECTED}),r=r.concat(`Hub unconnected. Status ${t.request.status}`)):m?(To(or.UNCONNECTED),r=r.concat("Cloud unconnected in remote"),O&&l&&(Io({hubId:l,state:ir.UNCONNECTED}),r=r.concat("Hub unconnected in remote"))):O&&l&&(Io({hubId:l,state:ir.UNCONNECTED}),r=r.concat("Hub unconnected")),console.error(r),n(t)}))})):n(new Error("SDK Error: Command or Command API URL not found."))})}function Jo(){return ro.selectors.getUser(bo.getState())}function Zo(){const e=bo.getState();return br.selectors.getDevices(e)}function Qo(){const e=bo.getState();return dr.selectors.getPairings(e)}function ei(){const e=bo.getState();return uo.selectors.getRooms(e)}function ti(e,t,r){return new Promise((n,o)=>{const i=bo.getState(),c=ro.selectors.getUser(i);if(!c||!c.authKey)return console.error("SDK sendRoomCmd error: No userKey!"),void o(new Error("Room command error: No userKey!"));const u=_r.selectors.getHubs(i),a=u[e],{hubKey:s}=u[e];if(!a||!s)return console.error("SDK sendRoomCmd error: No hubKey!"),void o(new Error("Room command error: No hubKey!"));if(a.connectionState!==ir.LOCAL&&a.connectionState!==ir.REMOTE)return console.error("SDK sendRoomCmd error: No Hub connection"),void o(new Error("Room command error: No hub connection"));const{authKey:f}=c;if(!f)return console.error("SDK sendRoomCmd error: No authKey!"),void o(new Error("Room command error: No authKey!"));t&&Xo({command:t,authKey:f,hubId:e,localUrl:a.url,hubKey:s,data:r}).then(t=>{console.debug("SDK sendRoomCmd ok",t),Xo({command:nr.CMD_GET_ROOMS,authKey:f,hubId:e,localUrl:a.url,hubKey:s}).then(t=>{console.debug("SDK sendRoomCmd refresh rooms ok",t),bo.dispatch(uo.actions.setRooms({hubId:e,rooms:t})),n(t)}).catch(e=>{console.error("SDK Room command error:",e),o(e)})}).catch(e=>{console.error("SDK Room command error:",e),o(e)})})}let ri,ni={};function oi(e,t){const r=t;r.hubId&&(r.id=r.hubId,delete r.hubId),r.id&&(ni[r.id]||(ni[r.id]={id:r.id,name:r.name||""}),ni[r.id].connected=r.connected,ni[r.id].features=r.features,ni[r.id].state=r.state,ni[r.id].version=r.version,ni[r.id].connectionState=r.connected?ir.REMOTE:ir.UNCONNECTED,e?(ni[r.id].connectionState=ir.LOCAL,ni[r.id].url=e):ni[r.id].url=void 0)}function ii(){return _r.selectors.getHubs(bo.getState())}function ci(){return new Promise(e=>{Xo({command:nr.CLOUD_IP}).then(t=>{const r=[];t&&!Zn(t)&&t.forEach(e=>{r.push(function(e){return new Promise(t=>{if(e){const r=`${_o+e}:${So}`;Xo({url:`${r}/hub`,timeout:500}).then(n=>{oi(r,n),t(e)}).catch(r=>{console.log(`doLocalIdQuery ${e} error `,r.message),t(e)})}else t()})}(e))}),Yo(r).finally(()=>{!function(e){const t=ii();Object.values(t).forEach(t=>{if(t.selected){const r=e[t.id];r&&(r.selected=!0)}})}(ni),bo.dispatch(_r.actions.updateHubs(ni)),e("ok")})}).catch(t=>{console.error("doCloudDiscovery error: ",t.message),bo.dispatch(_r.actions.updateHubs(ni)),e("error")})})}function ui(e,t){return new Promise(r=>{const n=[];Object.values(e).forEach(e=>{e.hubKey&&n.push(function(e,t,r){return new Promise((n,o)=>{Xo({command:nr.CLOUD_META,authKey:t,hubKey:r,hubId:e}).then(t=>{oi(void 0,t),n(e)}).catch(t=>{console.log(`doRemoteIdQuery ${e} error `,t.message),o(e)})})}(e.id,t,e.hubKey))}),Yo(n).then(e=>{console.debug("fetchCloudMetaData values",e)}).catch(e=>{console.error("fetchCloudMetaData error",e)}).finally(()=>{r()})})}function ai(){return ro.selectors.getUser(bo.getState())}function si(e,t=!1){const{authKey:r}=ai();return new Promise(n=>{ni=function(e){const t={};return e&&Object.keys(e).forEach(r=>{const n=Xt(e[r].split(".")[1]),o=JSON.parse(n),i={};i.id=o.hubId||o.hub_id,i.name=o.hubName||o.hub_name,i.hubKey=e[r],i.connectionState=ir.UNCONNECTED,o.role&&(i.role=o.role,i.roleString="",Object.keys(to).forEach(e=>{to[e]===i.role&&(i.roleString=e)})),t[i.id]=i}),t}(e),bo.dispatch(_r.actions.updateHubs(ni)),ui(ni,r).finally(()=>{bo.dispatch(_r.actions.updateHubs(ni)),t?ci().then(()=>n(ii())).catch(()=>n(ii())):(ci(),n(ii()))})})}function fi(){const{authKey:e}=ai();return new Promise((t,r)=>{e?Xo({command:nr.HUB_KEYS,authKey:e}).then(e=>{e?si(e).then(e=>t(e)):t(ii())}).catch(e=>{console.error("fetchHubTokens error: ",e.message),r(e)}):r(new Error("No userKey!"))})}function li(){ri||(fi(),ri=setInterval(fi,mo))}const di={},pi={},hi={},yi={};function vi(e,t=!1){return new Promise((r,n)=>{let o=t;if(pi[e])return console.debug("doPairing: pairing stopped"),void n(new Error("pairing stopped"));hi[e]||(hi[e]=0);const i=ii()[e],{authKey:c}=ai(),{hubKey:u}=i;if(console.debug("doPairing connection state: ",i.connectionState),i.connectionState!==ir.LOCAL&&i.connectionState!==ir.REMOTE)return console.warn("SDK doPairing: no Hub connection"),void n(new Error("no hub connection"));yi[e]?n(new Error("pairing already in action")):(yi[e]=!0,o&&(hi[e]=0),o=0===hi[e],Xo({command:nr.PAIR_START,hubId:e,authKey:c,hubKey:u,localUrl:i.url,data:{ts:hi[e]}}).then(t=>{if(t)switch(hi[e]=t.timestamp,t.type){case"SCAN_DELTA":!function(e,t,r){let n={};const o=Qo();o&&o[e]&&(n=o[e]);const i={hubId:e,devices:{}};r.map(e=>(i.devices[e.id]=e,!0)),t?bo.dispatch(dr.actions.setPairingDevices(i)):Object.entries(i.devices).forEach(([t,r])=>{const o={hubId:e,device:r};t&&r?bo.dispatch(dr.actions.setPairingDevice(o)):t&&n[t]&&bo.dispatch(dr.actions.deletePairingDevice(t))})}(e,o,t.devices)}yi[e]=!1,r("ok")}).catch(t=>{console.error("SDK: doPairing error: ",t.message),yi[e]=!1,n(t)}))})}const bi={};function gi(e){return new Promise((t,r)=>{if(bi[e])return void r(new Error("already stopping"));bi[e]=!0;const{authKey:n}=ai(),o=ii()[e],{hubKey:i}=o;clearInterval(di[e]),Xo({command:nr.PAIR_STOP,hubId:e,authKey:n,hubKey:i,localUrl:o.url}).then(r=>{console.debug("SDK: pairingStopped: Ok , data: ",r),pi[e]=!0,bi[e]=!1,t("ok")}).catch(t=>{console.error("SDK: pairingStopped error: ",t.message),bi[e]=!1,r(t)})})}const Ei={},mi={},Oi={},wi={},_i={};function Si(e,t=!1){return new Promise((r,n)=>{let o=t;if(o&&(Oi[e]=0),o=0===Oi[e],mi[e])return console.debug("doPolling: polling stopped"),void r("stopped");Oi[e]||(Oi[e]=0);const i=ii()[e];if(console.debug("doPoll connection state: ",i.connectionState),i.connectionState!==ir.LOCAL&&i.connectionState!==ir.REMOTE)return console.warn("SDK doPoll: No Hub connection"),void n(new Error("doPoll error: No Hub connection"));if(i.connectionState===ir.REMOTE&&!o){if(_i[e])return _i[e]=!1,void r("skipped");_i[e]=!0}const{authKey:c}=ai(),{hubKey:u}=i;wi[e]?n(new Error("doPoll error: Already polling")):(wi[e]=!0,Xo({command:nr.POLL,hubId:e,authKey:c,hubKey:u,localUrl:i.url,data:{ts:Oi[e]}}).then(t=>{t&&((0===Oi[e]||t.full)&&(o=!0),Oi[e]=t.timestamp,t.polls.forEach(t=>{switch(t.type){case"DEVICE_DELTA":!function(e,t,r){let n={};const o=Zo();if(o&&o[e]&&(n=o[e]),t){const t={hubId:e,devices:r};bo.dispatch(br.actions.setDevices(t))}else Object.entries(r).forEach(([t,r])=>{const o={hubId:e,device:r};t&&r?bo.dispatch(br.actions.setDevice(o)):t&&n[t]&&bo.dispatch(br.actions.deleteDevice(t))})}(e,o,t.devices);break;case"GROUP_DELTA":case"SCENE_DELTA":case"RULE_DELTA":case"USERS_DELTA":break;case"ROOM_DELTA":!function(e,t,r){let n={};const o=ei();if(o&&o[e]&&(n=o[e]),t){const t={hubId:e,rooms:r};bo.dispatch(uo.actions.setRooms(t))}else Object.entries(r).forEach(([t,r])=>{const o={hubId:e,room:r};t&&r?bo.dispatch(uo.actions.setRoom(o)):t&&n[t]&&bo.dispatch(uo.actions.removeRoom(t))})}(e,o,t.rooms)}})),wi[e]=!1,r("done")}).catch(t=>{console.error("SDK doPoll error: ",t.message),wi[e]=!1,n(t)}))})}function Ti(e){mi[e]=!1;const t=Oo,r=e=>Si(e).then(()=>{}).catch(()=>{});try{Ei[e]=setInterval(r,t,e)}catch(e){console.error("Catch startPollingById: ",e)}return Si(e)}function Ii(e){mi[e]=!0,clearInterval(Ei[e])}function Ai(e,t=!1){return new Promise((r,n)=>{const o=ii();if(!Zn(o)){let i=null,c=null;return Object.values(o).every(r=>e!==r.id||(bo.dispatch(_r.actions.selectHub({hubId:r.id})),r.hubKey&&t?(i=Ti(r.id),!1):r.hubKey?(console.debug("SDK selectHubById: Ready to start polling"),!1):(console.error("SDK selectHubById: No hub key error"),c=new Error("no hubKey"),!1))),i?i.then(e=>r(e)).catch(()=>r("polling started")):(c?n(c):!i&&t?n(new Error("hub not found")):r("ready to poll"),!0)}return n(new Error("no hubs")),!0})}go("user.state",e=>{e===eo.AUTHENTICATED&&li()});var Ni="[object Symbol]";var Di=function(e){return"symbol"==typeof e||jn(e)&&qr(e)==Ni},ji=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ci=/^\w*$/;var Pi=function(e,t){if(xn(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!Di(e))||(Ci.test(e)||!ji.test(e)||null!=t&&e in Object(t))},Ri=bn(Object,"create");var Ui=function(){this.__data__=Ri?Ri(null):{},this.size=0};var Ki=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},Li="__lodash_hash_undefined__",xi=Object.prototype.hasOwnProperty;var ki=function(e){var t=this.__data__;if(Ri){var r=t[e];return r===Li?void 0:r}return xi.call(t,e)?t[e]:void 0},Mi=Object.prototype.hasOwnProperty;var Hi=function(e){var t=this.__data__;return Ri?void 0!==t[e]:Mi.call(t,e)},Gi="__lodash_hash_undefined__";var zi=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=Ri&&void 0===t?Gi:t,this};function Fi(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Fi.prototype.clear=Ui,Fi.prototype.delete=Ki,Fi.prototype.get=ki,Fi.prototype.has=Hi,Fi.prototype.set=zi;var Bi=Fi;var $i=function(){this.__data__=[],this.size=0};var Vi=function(e,t){return e===t||e!=e&&t!=t};var Wi=function(e,t){for(var r=e.length;r--;)if(Vi(e[r][0],t))return r;return-1},Yi=Array.prototype.splice;var qi=function(e){var t=this.__data__,r=Wi(t,e);return!(r<0)&&(r==t.length-1?t.pop():Yi.call(t,r,1),--this.size,!0)};var Xi=function(e){var t=this.__data__,r=Wi(t,e);return r<0?void 0:t[r][1]};var Ji=function(e){return Wi(this.__data__,e)>-1};var Zi=function(e,t){var r=this.__data__,n=Wi(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this};function Qi(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Qi.prototype.clear=$i,Qi.prototype.delete=qi,Qi.prototype.get=Xi,Qi.prototype.has=Ji,Qi.prototype.set=Zi;var ec=Qi;var tc=function(){this.size=0,this.__data__={hash:new Bi,map:new(En||ec),string:new Bi}};var rc=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var nc=function(e,t){var r=e.__data__;return rc(t)?r["string"==typeof t?"string":"hash"]:r.map};var oc=function(e){var t=nc(this,e).delete(e);return this.size-=t?1:0,t};var ic=function(e){return nc(this,e).get(e)};var cc=function(e){return nc(this,e).has(e)};var uc=function(e,t){var r=nc(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this};function ac(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}ac.prototype.clear=tc,ac.prototype.delete=oc,ac.prototype.get=ic,ac.prototype.has=cc,ac.prototype.set=uc;var sc=ac,fc="Expected a function";function lc(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError(fc);var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var c=e.apply(this,n);return r.cache=i.set(o,c)||i,c};return r.cache=new(lc.Cache||sc),r}lc.Cache=sc;var dc=lc,pc=500;var hc=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,yc=/\\(\\)?/g,vc=function(e){var t=dc(e,(function(e){return r.size===pc&&r.clear(),e})),r=t.cache;return t}((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(hc,(function(e,r,n,o){t.push(n?o.replace(yc,"$1"):r||e)})),t}));var bc=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o},gc=1/0,Ec=kr?kr.prototype:void 0,mc=Ec?Ec.toString:void 0;var Oc=function e(t){if("string"==typeof t)return t;if(xn(t))return bc(t,e)+"";if(Di(t))return mc?mc.call(t):"";var r=t+"";return"0"==r&&1/t==-gc?"-0":r};var wc=function(e){return null==e?"":Oc(e)};var _c=function(e,t){return xn(e)?e:Pi(e,t)?[e]:vc(wc(e))},Sc=1/0;var Tc=function(e){if("string"==typeof e||Di(e))return e;var t=e+"";return"0"==t&&1/e==-Sc?"-0":t};var Ic=function(e,t){for(var r=0,n=(t=_c(t,e)).length;null!=e&&r<n;)e=e[Tc(t[r++])];return r&&r==n?e:void 0},Ac=function(){try{var e=bn(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Nc=function(e,t,r){"__proto__"==t&&Ac?Ac(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r},Dc=Object.prototype.hasOwnProperty;var jc=function(e,t,r){var n=e[t];Dc.call(e,t)&&Vi(n,r)&&(void 0!==r||t in e)||Nc(e,t,r)},Cc=9007199254740991,Pc=/^(?:0|[1-9]\d*)$/;var Rc=function(e,t){var r=typeof e;return!!(t=null==t?Cc:t)&&("number"==r||"symbol"!=r&&Pc.test(e))&&e>-1&&e%1==0&&e<t};var Uc=function(e,t,r,n){if(!Xr(e))return e;for(var o=-1,i=(t=_c(t,e)).length,c=i-1,u=e;null!=u&&++o<i;){var a=Tc(t[o]),s=r;if(o!=c){var f=u[a];void 0===(s=n?n(f,a,u):void 0)&&(s=Xr(f)?f:Rc(t[o+1])?[]:{})}jc(u,a,s),u=u[a]}return e};var Kc=function(e,t,r){for(var n=-1,o=t.length,i={};++n<o;){var c=t[n],u=Ic(e,c);r(u,c)&&Uc(i,_c(c,e),u)}return i};var Lc=function(e,t){return null!=e&&t in Object(e)};var xc=function(e,t,r){for(var n=-1,o=(t=_c(t,e)).length,i=!1;++n<o;){var c=Tc(t[n]);if(!(i=null!=e&&r(e,c)))break;e=e[c]}return i||++n!=o?i:!!(o=null==e?0:e.length)&&Mn(o)&&Rc(c,o)&&(xn(e)||Ln(e))};var kc=function(e,t){return null!=e&&xc(e,t,Lc)};var Mc=function(e,t){return Kc(e,t,(function(t,r){return kc(e,r)}))};var Hc=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e},Gc=kr?kr.isConcatSpreadable:void 0;var zc=function(e){return xn(e)||Ln(e)||!!(Gc&&e&&e[Gc])};var Fc=function e(t,r,n,o,i){var c=-1,u=t.length;for(n||(n=zc),i||(i=[]);++c<u;){var a=t[c];r>0&&n(a)?r>1?e(a,r-1,n,o,i):Hc(i,a):o||(i[i.length]=a)}return i};var Bc=function(e){return(null==e?0:e.length)?Fc(e,1):[]};var $c=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)},Vc=Math.max;var Wc=function(e,t,r){return t=Vc(void 0===t?e.length-1:t,0),function(){for(var n=arguments,o=-1,i=Vc(n.length-t,0),c=Array(i);++o<i;)c[o]=n[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=n[o];return u[t]=r(c),$c(e,this,u)}};var Yc=function(e){return function(){return e}};var qc=Ac?function(e,t){return Ac(e,"toString",{configurable:!0,enumerable:!1,value:Yc(t),writable:!0})}:function(e){return e},Xc=800,Jc=16,Zc=Date.now;var Qc=function(e){var t=0,r=0;return function(){var n=Zc(),o=Jc-(n-r);if(r=n,o>0){if(++t>=Xc)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(qc);var eu=function(e){return Qc(Wc(e,void 0,Bc),e+"")}((function(e,t){return null==e?{}:Mc(e,t)}));function tu(e,t,r,n,o){return new Promise((t,i)=>{const c=bo.getState(),u=ro.selectors.getUser(c);if(!u||!u.authKey)return console.error("SDK sendDeviceCmd error: No userKey!"),void i(new Error("Device command error: No userKey!"));const a=_r.selectors.getHubs(c),s=a[e],{hubKey:f}=a[e];if(!s||!f)return console.error("SDK sendDeviceCmd error: No hubKey!"),void i(new Error("Device command error: No hubKey!"));if(s.connectionState!==ir.LOCAL&&s.connectionState!==ir.REMOTE)return console.error("SDK sendDeviceCmd error: No Hub connection"),void i(new Error("Device command error: No hub connection"));const{authKey:l}=u;if(!l)return console.error("SDK sendDeviceCmd error: No authKey!"),void i(new Error("Device command error: No hubKey!"));let d=n;Zn(o)||(d=eu(d,o)),r&&Xo({command:r,method:void 0,authKey:l,hubId:e,localUrl:s.url,hubKey:f,data:[d]}).then(e=>{console.debug("SDK sendDeviceCmd ok",e),t(e)}).catch(e=>{console.error("SDK sendDeviceCmd error:",e),i(new Error("Device command error!"))})})}e.CLOUD_CONNECTION_STATES=or,e.HUB_CONNECTION_STATES=ir,e.HUB_STATES=Eo,e.LANGUAGES=Qn,e.ROLES=to,e.USER_STATES=eo,e.acceptEula=function(){return bo.dispatch(ro.actions.setEula(!0)),Jo().state===eo.WAITING_EULA&&bo.dispatch(ro.actions.changeState(eo.EULA_ACCEPTED)),!0},e.addRoom=async function(e,t){return new Promise((r,n)=>{ti(e,nr.CMD_SET_ROOM,[t]).then(e=>{r(e)}).catch(e=>{n(e)})})},e.changeLanguage=function(e){let t=!1;return Object.values(Qn).indexOf(e)>-1&&(bo.dispatch(ro.actions.setLanguage(e)),t=!0,Jo().state===eo.WAITING_LANGUAGE&&bo.dispatch(ro.actions.changeState(eo.LANGUAGE_SET))),t},e.connectHubByTokens=function(e,t,r=!0){return new Promise((n,o)=>{const{authKey:i}=ai();e||o(new Error("No Hub Id")),t||o(new Error("No hubKey")),i||o(new Error("No AuthKey"));const c={};c[e]=t,si(c,r).then(()=>{Ai(e,!1).then(()=>{n(ii())}).catch(e=>o(e))}).catch(e=>o(e))})},e.cozifyReducer=fo,e.deleteDevice=Or,e.devicesState=br,e.doPoll=Si,e.doPwLogin=function(e,t){return new Promise((r,n)=>{Xo({command:nr.USER_LOGIN,data:{email:e,password:t}}).then(e=>{e&&No(e)&&(bo.dispatch(ro.actions.setAuthKey(e)),Jo().state===eo.WAITING_LOGIN&&bo.dispatch(ro.actions.changeState(eo.LOGIN_DONE))),r(e)}).catch(e=>{console.debug("doPwLogin error",e),n(new Error("Login failure"))})})},e.editRoom=async function(e,t){return new Promise((r,n)=>{ti(e,nr.CMD_SET_ROOM,[t]).then(e=>{r(e)}).catch(e=>{n(e)})})},e.getCloudConnectionState=function(){const e=bo.getState();return cr.selectors.getConnections(e).cloudState},e.getDevices=Zo,e.getHubConnectionState=function(e){const t=bo.getState();return _r.selectors.getHubs(t)[e]?_r.selectors.getHubs(t)[e].connectionState:ir.UNCONNECTED},e.getHubDevices=function(e){let t;const r=Zo();return r&&r[e]&&(t=r[e]),t},e.getHubPairingDevices=function(e){let t;const r=Qo();return r&&r[e]&&(t=r[e]),t},e.getHubRooms=function(e){let t;const r=ei();return r&&r[e]&&(t=r[e]),t},e.getHubs=ii,e.getPairingDevices=Qo,e.getRooms=ei,e.getUserState=function(){return Jo().state},e.hubsState=_r,e.identifyDevice=function(e,t){return tu(e,0,nr.CMD_DEVICE_IDENTIFY,{id:t})},e.ignorePairingByIds=function(e,t,r){const{authKey:n}=ai(),o=ii()[e],{hubKey:i}=o;return Xo({command:nr.PAIR_IGNORE,hubId:e,authKey:n,hubKey:i,localUrl:o.url,data:{id:t,ignored:r}})},e.removeRoom=async function(e,t){return new Promise((r,n)=>{ti(e,nr.CMD_REMOVE_ROOM,{roomId:t.id}).then(e=>{r(e)}).catch(t=>{if(t.response&&t.response.status&&404===t.response.status){const t=ei();r(t[e])}n(t)})})},e.selectHubById=Ai,e.sendDeviceCmd=tu,e.sendDeviceStateCmd=function(e,t,r,n){return new Promise((o,i)=>{const c=bo.getState(),u=ro.selectors.getUser(c);if(!u||!u.authKey)return console.error("SDK sendDeviceStateCmd error: No userKey!"),void i(new Error("Device command error: No userKey!"));const a=_r.selectors.getHubs(c);if(!a[e]||!a[e].hubKey)return console.error("SDK sendDeviceStateCmd error: No hubKey!"),void i(new Error("Device command error: No hubKey!"));const{authKey:s}=u,{hubKey:f}=a[e];let l=r;Zn(n)||(l=eu(l,n)),Xo({command:nr.CMD_DEVICE_STATE,authKey:s,hubId:e,hubKey:f,data:[{id:t,state:l}]}).then(e=>{console.debug("SDK sendDeviceCmd ok",e),o(e)}).catch(e=>{console.error(e),console.error("SDK sendDeviceStateCmd error:",e),i(new Error("Device state command error!"))})})},e.setAuthenticated=function(e){return bo.dispatch(ro.actions.setAuthenticated(e)),Jo()},e.setDeviceMeta=function(e,t,r,n){return tu(e,0,nr.CMD_DEVICE_META,{id:t,name:r,room:n})},e.setDevices=mr,e.startDiscoveringHubs=li,e.startPairingById=function(e,t){const r=wo;pi[e]=!1;const n=(e,t)=>vi(e,t).then(()=>{}).catch(()=>{});try{di[e]=setInterval(n,r,e,t)}catch(e){console.error("Catch startPairingById: ",e)}return vi(e,t)},e.startPollingById=Ti,e.stopDiscoveringHubs=function(){clearInterval(ri)},e.stopPairingById=gi,e.stopPairings=function(){const e=ii();Object.values(e).forEach(e=>{gi(e.id).then(()=>console.debug("SDK: pairingStopped: ",e.id)).catch(()=>console.log("SDK: pairingStopped error: ",e.id))})},e.stopPollingById=Ii,e.store=bo,e.unSelectHubById=function(e){const t=ii();Object.values(t).forEach(t=>{e===t.id&&(bo.dispatch(_r.actions.unSelectHub({hubId:t.id})),Ii(t.id))})},e.unSelectHubs=function(){const e=ii();Object.values(e).forEach(e=>{bo.dispatch(_r.actions.unSelectHub({hubId:e.id})),Ii(e.id)})},e.unpairDevice=function(e,t){return tu(e,0,nr.CMD_DEVICE_IGNORE,{id:t})},e.updateHubs=Ir,e.useTestcloud=function(){er=Zt},e.watchChanges=go,Object.defineProperty(e,"__esModule",{value:!0})}));
